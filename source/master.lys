\version "2.23.10"

stBass = \markup \larger \box Г % Готовий
frBass = \markup \larger \box В % Вибiрний
puBass = \markup \larger \box Б % Чистий бас

{% macro logo(scale = 1) %}
\roman \bold {
  \magnify #{{ 1.5 * scale }} \musicglyph "clefs.G"
  \magnify #{{ 2.5 * scale }} {
    \rotate #30 Б
    \lower #{{ 0.75 * scale }} а
    \raise #{{ 0.75 * scale }} я
    \rotate #-30 Н
  }
}
{% endmacro %}

\paper {
  print-all-headers = ##t
}

{% set url = "https://volodymyrprokopyuk.github.io/bayan" %}
{% if pieces.length > 1 %}
\header {
  title = "{{ book.tit }}"
  subtitle = "{{ book.sub }}"
  tagline = \markup { {{ logo(0.5) }} \with-url "{{ url }}" "{{ url }}" }
}
\markuplist \table-of-contents
{% else %}
\header {
  tagline = \markup { {{ logo(0.5) }} \with-url "{{ url }}" "{{ url }}" }
}
{% endif %}

{% macro rhConfig() %}
\override Score.BarNumber.break-visibility = ##(#f #f #f)
\override DynamicLineSpanner.staff-padding = #2.5
{% endmacro %}

{% macro lhConfig() %} {% endmacro %}

{% for piece in pieces %}
\tocItem \markup "{{ piece.tit }}"
\score {
  \header {
    title = "{{ piece.tit }}"
    subtitle = "{{ piece.sub | safe or '' }}"
    {% if piece.com %}
    composer = "{{ piece.com }}"
    {% endif %}
    {% if piece.arr %}
    arranger = "{{ piece.arr }}"
    {% endif %}
  }
  {% set source = "source/" + piece.src + "/" + piece.file + ".lys" %}
  {% from source import rightHand, leftHand %}
  \new PianoStaff = bayan {
    <<
      \new Staff = rightHand { {{ rightHand(rhConfig) }} }
      \new Staff = leftHand { {{ leftHand(lhConfig) }} }
    >>
  }
}
{% endfor %}
